<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Submission</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/submitIllustStyle.css">

</head>

<body>
  <%- include('../navbar', LoginData) %>
  <div class="main__head">

  </div>
  <!-- partial:index.partial.html -->
  <div class="ile_container">
    <div class="ile_left">
      <form action="/multiple-upload" method="POST">

        <div class="container mt-4 add_illust p-3">
          <i class="fa-solid fa-upload my-3 title"> Publicar nueva ilustración</i>
          <div class="scrolls">
            <div class="">
              <div class="preview-images"></div>
            </div>
          </div>
          <div class="form-group my-3">
            <input type="file" name="multi-files" multiple required id="input-multi-files" class="form-control-file border" />
          </div>
          <div class="form__fields">
            <div class="title_div mb-2">
              <input type="text" required placeholder="Dale un titulo a tu ilustración">
            </div>
            <div class="description_div">
              <input type="textarea" placeholder="Dile a los demás de que trata tu trabajo.">
            </div>
            <div class="tags_div">
              <label for="">Agrega etiquetas</label>
              <!-- <input id="tokenfield" type="text" > -->

              <div class="text-area">
                <div class="label">Type Tags</div>
                <span class="tags">
                  <!-- <span>Hello</span>
                    <span>World</span> -->
                </span>
                <input id ="tags" type="text">
              </div>

              <script>
                const input = document.querySelector('#tags')
                const text_area = document.querySelector('.text-area')
                const tags_container = document.querySelector('.tags')

                text_area.addEventListener('click', () => {
                  text_area.classList.add('focused')
                  input.focus()
                })

                input.addEventListener('blur', () => {
                  if (tags_container.innerText == '') {
                    text_area.classList.remove('focused')
                  } else {
                    text_area.classList.add('focused')
                  }
                })

                input.addEventListener('keyup', (e) => {
                  if (e.code == 'Space') {
                    if (input.value !== ' ') {
                      create_span(input.value)
                    }
                    input.value = ''
                  }
                })

                function create_span(span_text) {
                  const span = document.createElement('span')
                  span.innerText = span_text

                  tags_container.append(span)

                  const tags = document.querySelectorAll('.tags span')
                  remove_tag(tags)
                }

                function remove_tag(tags) {
                  tags.forEach(tag => {
                    tag.addEventListener('click', () => tag.remove())
                  })
                }
              </script>


              <div class="form-data"></div>
            </div>
          </div>
          <button type="submit" class="btn btn-primary">Publicar</button>
        </div>
      </form>
    </div>

    <div class="ile_right">
      <div class="ile_r_content">
        <h3>Especificación de Contenido</h3>
        <fieldset>
          <legend>Publico</legend>
          <label>
            <input type="radio" name="nsfw" value="true"> NSFW
          </label>
          <label>
            <input type="radio" name="nsfw" value="false"> SFW
          </label>
        </fieldset>
        <fieldset>
          <legend>Permisos de IA</legend>
          <label>
            <input type="radio" name="allow-ia" value="true"> Permitir
          </label>
          <label>
            <input type="radio" name="allow-ia" value="false"> No permitir
          </label>
        </fieldset>
        <fieldset>
          <legend>Tipo de ilustración</legend>
          <label>
            <input type="radio" name="original" value="azul"> Comision
          </label>
          <label>
            <input type="radio" name="original" value="negro"> Request
          </label>
          <label>
            <input type="radio" name="original" value="negro" checked> Original
          </label>
        </fieldset>
      </div>
    </div>
  </div>

  <!-- partial -->
  <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
  <script src="./script.js"></script>

  <script src="https://kit.fontawesome.com/b086d2a54c.js" crossorigin="anonymous"></script>
  <script>
    $(document).ready(function() {
      $('#tokenfield').tokenfield({
        autocomplete: {
          source: ['red', 'blue', 'green', 'yellow', 'violet', 'brown', 'purple', 'black', 'white'],
          delay: 100
        },
        showAutocompleteOnFocus: true
      });

      $("form").submit(function(e) {
        e.preventDefault();
        $('.form-data').text($('#tokenfield').val());
      });
      let imagesPreview = function(input, placeToInsertImagePreview) {
        if (input.files) {
          let filesAmount = input.files.length;
          for (i = 0; i < filesAmount; i++) {
            let reader = new FileReader();
            reader.onload = function(event) {
              $($.parseHTML("<img>"))
                .attr("src", event.target.result)
                .appendTo(placeToInsertImagePreview);
            };
            reader.readAsDataURL(input.files[i]);
          }
        }
      };
      $("#input-multi-files").on("change", function() {
        imagesPreview(this, "div.preview-images");
      });
    });
  </script>
</body>

</html>